<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UPSC Ascent - Answer Writing Practice</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8FAFC; /* Light gray background */
            line-height: 1.6;
            color: #333; /* Darker default text for readability */
        }
        /* Custom scrollbar for better aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .animate-fade-in { animation: fadeIn 0.6s ease-out forwards; }

        /* Question Card Styling */
        .question-card {
            background-color: #FFFFFF;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1); /* More prominent shadow */
            transition: all 0.3s ease;
            overflow: hidden;
            border: 1px solid #E2E8F0; /* Light border */
        }
        .question-card:hover {
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
            transform: translateY(-5px);
        }

        .question-header {
            background-color: #3B82F6; /* Blue-500 */
            color: white;
            padding: 1.5rem;
            font-size: 1.25rem;
            font-weight: 700;
            border-top-left-radius: 0.75rem;
            border-top-right-radius: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .question-body {
            padding: 1.5rem;
            font-size: 1.125rem;
            color: #2D3748;
            line-height: 1.7;
        }
        .question-meta {
            display: flex;
            justify-content: space-around;
            padding: 1rem 1.5rem;
            background-color: #F0F9FF; /* Very light blue */
            border-top: 1px solid #E0F2F7;
            border-bottom: 1px solid #E0F2F7;
        }
        .question-meta-item {
            text-align: center;
            font-size: 0.875rem;
            color: #4A5568;
        }
        .question-meta-item strong {
            display: block;
            font-size: 1.125rem;
            color: #2D3748;
            margin-bottom: 0.25rem;
        }

        /* Model Answer Section */
        .model-answer-details {
            margin-top: 1.5rem;
            border: 1px solid #CBD5E0; /* gray-300 */
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .model-answer-summary {
            background-color: #E2E8F0; /* gray-200 */
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-weight: 600;
            color: #2D3748;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.125rem;
        }
        .model-answer-summary::after {
            content: '▼';
            margin-left: 1rem;
            transition: transform 0.2s;
        }
        details[open] .model-answer-summary::after {
            content: '▲';
            transform: rotate(180deg);
        }
        .model-answer-content {
            padding: 1.5rem;
            background-color: #F7FAFC; /* Lightest gray */
            line-height: 1.8;
            color: #4A5568;
            font-size: 1rem;
        }
        /* Styling for content within model-answer-content div (HTML from admin) */
        .model-answer-content h2, .model-answer-content h3, .model-answer-content h4 {
            font-weight: 600;
            color: #2D3748;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }
        .model-answer-content h2 { font-size: 1.5rem; }
        .model-answer-content h3 { font-size: 1.25rem; }
        .model-answer-content h4 { font-size: 1.125rem; }
        .model-answer-content p {
            margin-bottom: 1rem;
        }
        .model-answer-content ul, .model-answer-content ol {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
            list-style-position: outside;
        }
        .model-answer-content ul {
            list-style-type: disc;
        }
        .model-answer-content ol {
            list-style-type: decimal;
        }
        .model-answer-content li {
            margin-bottom: 0.5rem;
        }
        .model-answer-content table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-radius: 0.5rem;
            overflow: hidden;
        }
        .model-answer-content th, .model-answer-content td {
            border: 1px solid #E2E8F0;
            padding: 0.75rem 1rem;
            text-align: left;
        }
        .model-answer-content th {
            background-color: #F1F5F9;
            font-weight: 600;
            color: #4A5568;
            text-transform: uppercase;
            font-size: 0.875rem;
        }
        .model-answer-content tr:nth-child(even) {
            background-color: #F7FAFC;
        }
        .model-answer-content tr:hover {
            background-color: #EDF2F7;
        }

        .official-link-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            background-color: #4CAF50; /* Green */
            color: white;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
            margin-top: 1rem;
        }
        .official-link-btn:hover {
            background-color: #45A049;
            transform: translateY(-2px);
        }

        /* Timer Styling */
        #timer-display {
            font-size: 2.5rem;
            font-weight: 700;
            color: #3B82F6;
            margin-bottom: 1rem;
            text-align: center;
        }
        .timer-buttons button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
        }
        .timer-buttons button:hover {
            transform: translateY(-2px);
        }
        .start-timer-btn { background-color: #28A745; color: white; } /* Green */
        .start-timer-btn:hover { background-color: #218838; }
        .pause-timer-btn { background-color: #FFC107; color: #333; } /* Yellow */
        .pause-timer-btn:hover { background-color: #E0A800; }
        .reset-timer-btn { background-color: #DC3545; color: white; } /* Red */
        .reset-timer-btn:hover { background-color: #C82333; }
        .timer-buttons button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header - Consistent with other pages -->
    <header class="bg-white shadow-md fixed w-full z-10 py-4">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <a href="index.html" class="text-3xl font-extrabold text-[#1A202C]">UPSC</a>
            <nav class="hidden md:block">
                <ul class="flex items-center space-x-8">
                    <li><a href="index.html" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors duration-200">Home</a></li>
                    <li><a href="syllabus.html" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors duration-200">Syllabus</a></li>
                    <li><a href="study-planner.html" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors duration-200">Study Planner</a></li>
                    <li><a href="study-material.html" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors duration-200">Study Material</a></li>
                    <li><a href="current-affairs.html" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors duration-200">Current Affairs & Quizzes</a></li>
                    <li><a href="pyqs.html" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors duration-200">PYQs</a></li>
                    <li><a href="answer-writing.html" class="text-blue-600 font-bold text-lg transition-colors duration-200">Answer Writing</a></li>
                    <li><a href="admin.html" class="bg-blue-600 text-white px-6 py-2 rounded-full font-semibold hover:bg-blue-700 transition-colors duration-200 shadow-md">Admin Login</a></li>
                </ul>
            </nav>
            <!-- Mobile Menu Button -->
            <button id="mobile-menu-button" class="md:hidden text-gray-700 focus:outline-none">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </div>
        <!-- Mobile Menu Overlay -->
        <div id="mobile-menu-overlay" class="fixed inset-0 bg-black bg-opacity-75 z-20 hidden md:hidden">
            <div class="absolute right-0 top-0 h-full w-3/4 bg-white shadow-lg p-6 transform translate-x-full transition-transform duration-300 ease-in-out">
                <button id="close-mobile-menu" class="absolute top-4 right-4 text-gray-700 focus:outline-none">
                    <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <ul class="flex flex-col space-y-4 mt-12">
                    <li><a href="index.html" class="block text-gray-800 hover:text-blue-600 font-medium text-xl py-2">Home</a></li>
                    <li><a href="syllabus.html" class="block text-gray-800 hover:text-blue-600 font-medium text-xl py-2">Syllabus</a></li>
                    <li><a href="study-planner.html" class="block text-gray-800 hover:text-blue-600 font-medium text-xl py-2">Study Planner</a></li>
                    <li><a href="study-material.html" class="block text-gray-800 hover:text-blue-600 font-medium text-xl py-2">Study Material</a></li>
                    <li><a href="current-affairs.html" class="block text-gray-800 hover:text-blue-600 font-medium text-xl py-2">Current Affairs & Quizzes</a></li>
                    <li><a href="pyqs.html" class="block text-gray-800 hover:text-blue-600 font-medium text-xl py-2">PYQs</a></li>
                    <li><a href="answer-writing.html" class="block text-gray-800 hover:text-blue-600 font-medium text-xl py-2">Answer Writing</a></li>
                    <li><a href="admin.html" class="block bg-blue-600 text-white px-6 py-3 rounded-full font-semibold hover:bg-blue-700 transition-colors duration-200 shadow-md text-center mt-4">Admin Login</a></li>
                </ul>
            </div>
        </div>
    </header>

    <main class="flex-grow pt-24 pb-12">
        <section class="container mx-auto px-4 py-8">
            <h1 class="text-4xl md:text-5xl font-extrabold text-center text-gray-800 mb-12 leading-tight">
                Mains Answer Writing Practice
            </h1>

            <!-- Featured Question / Question of the Day -->
            <div id="featured-question-container" class="mb-12">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Question of the Day</h2>
                <div id="qotd-content">
                    <p class="text-center text-gray-500 text-lg">Loading question...</p>
                </div>
            </div>

            <!-- Previous Questions Section -->
            <div class="mt-16">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">Previous Questions</h2>
                <div id="previous-questions-container" class="grid grid-cols-1 gap-6">
                    <p class="text-center text-gray-500 text-lg">Loading previous questions...</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer - Consistent with other pages -->
    <footer class="bg-gray-800 text-white p-6 text-center mt-12 rounded-t-lg shadow-inner">
        <div class="container mx-auto">
            <p class="mb-2">&copy; 2025 UPSC Ascent. All rights reserved.</p>
            <p class="text-sm opacity-80">Designed for UPSC Aspirants with dedication and precision.</p>
            <div class="flex justify-center space-x-4 mt-4">
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200 text-sm">Privacy Policy</a>
                <span class="text-gray-500">|</span>
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200 text-sm">Terms of Service</a>
                <span class="text-gray-500">|</span>
                <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200 text-sm">Contact Us</a>
            </div>
        </div>
    </footer>

    <!-- Firebase SDKs and Integrated JavaScript -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, query, limit, onSnapshot, orderBy } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        // Your Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAn0XLw2XA26UBf4OevQkqp5UESakQI8kg",
            authDomain: "upscbuddy-5050d.firebaseapp.com",
            projectId: "upscbuddy-5050d",
            storageBucket: "upscbuddy-5050d.firebasestorage.app",
            messagingSenderId: "632136482996",
            appId: "1:632136482996:web:4bebdeb43c266398d697e1",
            measurementId: "G-QLVRYRJFL2"
        };

        // Global variables for Firebase instances
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const currentAppId = firebaseConfig.appId.split(':')[1]; // Extract appId from the provided config

        // Store unsubscribe functions for real-time listeners to prevent memory leaks
        const unsubscribeFunctions = {};

        // Timer variables
        let timerInterval;
        let timeLeft = 0; // in seconds
        let isTimerRunning = false;
        let currentQuestionTimeLimit = 0; // Store the time limit for the current question

        // Function to format time for display
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        // Function to update timer display
        function updateTimerDisplay() {
            document.getElementById('timer-display').textContent = formatTime(timeLeft);
        }

        // Function to start the timer
        function startTimer() {
            if (isTimerRunning || timeLeft <= 0) return;

            isTimerRunning = true;
            document.getElementById('start-timer-btn').disabled = true;
            document.getElementById('pause-timer-btn').disabled = false;
            document.getElementById('reset-timer-btn').disabled = false;

            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    isTimerRunning = false;
                    document.getElementById('start-timer-btn').disabled = true;
                    document.getElementById('pause-timer-btn').disabled = true;
                    showCustomModal('Time Up!', 'Your time for this question has ended. Review your answer!', 'info');
                }
            }, 1000);
        }

        // Function to pause the timer
        function pauseTimer() {
            clearInterval(timerInterval);
            isTimerRunning = false;
            document.getElementById('start-timer-btn').disabled = false;
            document.getElementById('pause-timer-btn').disabled = true;
        }

        // Function to reset the timer
        function resetTimer() {
            clearInterval(timerInterval);
            isTimerRunning = false;
            timeLeft = currentQuestionTimeLimit; // Reset to the question's original time limit
            updateTimerDisplay();
            document.getElementById('start-timer-btn').disabled = false;
            document.getElementById('pause-timer-btn').disabled = true;
            document.getElementById('reset-timer-btn').disabled = true;
        }

        // Event listeners for timer buttons
        document.addEventListener('click', (event) => {
            if (event.target.id === 'start-timer-btn') {
                startTimer();
            } else if (event.target.id === 'pause-timer-btn') {
                pauseTimer();
            } else if (event.target.id === 'reset-timer-btn') {
                resetTimer();
            }
        });


        // Function to create HTML for an answer writing question
        function createAnswerWritingQuestionHtml(item, isFeatured = false) {
            const dateDisplay = item.date ? `<span class="text-sm text-gray-600">${item.date}</span>` : '';
            const difficultyColor = {
                'Easy': 'bg-green-100 text-green-800',
                'Medium': 'bg-yellow-100 text-yellow-800',
                'Hard': 'bg-red-100 text-red-800'
            }[item.difficulty] || 'bg-gray-100 text-gray-800';

            // Sanitize and render modelAnswerContent as HTML
            const sanitizedModelAnswer = DOMPurify.sanitize(item.modelAnswerContent || 'No model answer available.');

            let questionCardHtml = `
                <div class="question-card animate-fade-in">
                    <div class="question-header">
                        <span>Question ${isFeatured ? 'of the Day' : ''}</span>
                        ${dateDisplay}
                    </div>
                    <div class="question-body">
                        <p class="font-semibold text-lg mb-4">${item.question || 'No question provided.'}</p>
                        <div class="question-meta">
                            <div class="question-meta-item">
                                <strong>Difficulty:</strong>
                                <span class="px-2 py-1 rounded-full ${difficultyColor}">${item.difficulty || 'N/A'}</span>
                            </div>
                            <div class="question-meta-item">
                                <strong>Marks:</strong>
                                <span>${item.marks || 'N/A'}</span>
                            </div>
                            <div class="question-meta-item">
                                <strong>Time Limit:</strong>
                                <span>${item.timeLimitMinutes ? `${item.timeLimitMinutes} min` : 'N/A'}</span>
                            </div>
                        </div>

                        ${isFeatured ? `
                            <div class="flex flex-col items-center mt-6">
                                <div id="timer-display" class="mb-4">${formatTime(item.timeLimitMinutes * 60 || 0)}</div>
                                <div class="timer-buttons flex space-x-4">
                                    <button id="start-timer-btn" class="start-timer-btn" ${item.timeLimitMinutes ? '' : 'disabled'}>Start Timer</button>
                                    <button id="pause-timer-btn" class="pause-timer-btn" disabled>Pause Timer</button>
                                    <button id="reset-timer-btn" class="reset-timer-btn" disabled>Reset Timer</button>
                                </div>
                            </div>
                        ` : ''}

                        <div class="model-answer-details mt-6">
                            <details>
                                <summary class="model-answer-summary">View Model Answer</summary>
                                <div class="model-answer-content">
                                    ${sanitizedModelAnswer}
                                    ${item.officialLink ? `
                                        <a href="${item.officialLink}" target="_blank" class="official-link-btn">
                                            View Official Resource
                                            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 5l7 7-7 7"></path></svg>
                                        </a>
                                    ` : ''}
                                </div>
                            </details>
                        </div>
                    </div>
                </div>
            `;
            return questionCardHtml;
        }

        /**
         * Generic function to load content for a given collection using real-time listeners (onSnapshot).
         * @param {string} collectionName - The name of the Firestore collection.
         * @param {string} containerId - The ID of the HTML element where content will be displayed.
         * @param {number|null} limitCount - Optional. The maximum number of documents to retrieve.
         * @param {boolean} isFeaturedSection - True if loading for the featured section (QOTD).
         */
        function loadContent(collectionName, containerId, limitCount = null, isFeaturedSection = false) {
            const container = document.getElementById(containerId);
            if (!container) {
                console.error(`Container with ID '${containerId}' not found.`);
                return;
            }

            // If there's an existing listener for this container, unsubscribe it first
            if (unsubscribeFunctions[containerId]) {
                unsubscribeFunctions[containerId]();
                delete unsubscribeFunctions[containerId];
            }

            container.innerHTML = `<p class="text-center text-gray-500 col-span-full py-8 text-lg">Loading ${collectionName}...</p>`;

            try {
                let q = collection(db, `artifacts/${currentAppId}/public/data/${collectionName}`);
                // Order by date in descending order for answer writing
                q = query(q, orderBy('date', 'desc'));
                if (limitCount) {
                    q = query(q, limit(limitCount));
                }

                // Set up the real-time listener
                const unsubscribe = onSnapshot(q, (querySnapshot) => {
                    let htmlContent = '';
                    if (querySnapshot.empty) {
                        htmlContent = `<p class="text-center text-gray-600 text-xl col-span-full py-8">No ${collectionName} available yet. Check back soon!</p>`;
                    } else {
                        // For featured section, take the first (latest) item
                        if (isFeaturedSection) {
                            const latestDoc = querySnapshot.docs[0];
                            if (latestDoc) {
                                const data = latestDoc.data();
                                htmlContent = createAnswerWritingQuestionHtml(data, true);
                                // Initialize timer for the featured question
                                currentQuestionTimeLimit = data.timeLimitMinutes ? data.timeLimitMinutes * 60 : 0;
                                timeLeft = currentQuestionTimeLimit;
                                updateTimerDisplay();
                                document.getElementById('start-timer-btn').disabled = (currentQuestionTimeLimit === 0);
                                document.getElementById('pause-timer-btn').disabled = true;
                                document.getElementById('reset-timer-btn').disabled = true;
                            } else {
                                htmlContent = `<p class="text-center text-gray-600 text-xl col-span-full py-8">No featured question available.</p>`;
                            }
                        } else {
                            // For previous questions, skip the first one if it's the featured one
                            // Or if limitCount is used, it will already be limited.
                            // We need to ensure the featured question is not duplicated in the previous questions list.
                            const docsToDisplay = isFeaturedSection ? [] : (limitCount ? querySnapshot.docs.slice(1) : querySnapshot.docs); // If featured, remove first. If limit, it's already limited.

                            docsToDisplay.forEach((doc) => {
                                const data = doc.data();
                                htmlContent += createAnswerWritingQuestionHtml(data, false);
                            });
                        }
                    }
                    container.innerHTML = htmlContent;
                }, (error) => {
                    console.error(`Error listening to ${collectionName}:`, error);
                    container.innerHTML = `<p class="text-center text-red-600 text-lg col-span-full py-8">Failed to load ${collectionName}. Please try again later.</p>`;
                    showCustomModal('Error', `Failed to load ${collectionName}. Please check your internet connection or try again later.`, 'error');
                });

                // Store the unsubscribe function
                unsubscribeFunctions[containerId] = unsubscribe;

            } catch (error) {
                console.error(`Error setting up listener for ${collectionName}:`, error);
                container.innerHTML = `<p class="text-center text-red-600 text-lg col-span-full py-8">Failed to initialize ${collectionName} listener. Please try again later.</p>`;
                showCustomModal('Error', `Failed to initialize ${collectionName} listener. Error: ${error.message}`, 'error');
            }
        }

        // Custom modal function (instead of alert/confirm)
        function showCustomModal(title, message, type = 'info', callback = null) {
            const modalId = 'custom-modal-' + Date.now();
            const modalHtml = `
                <div id="${modalId}" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-lg shadow-xl max-w-sm w-full mx-auto p-6 transform transition-all duration-300 scale-95 opacity-0" style="animation: modal-fade-in 0.3s forwards;">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold ${type === 'error' ? 'text-red-600' : 'text-blue-600'}">${title}</h3>
                            <button class="text-gray-500 hover:text-gray-700 close-modal-btn" data-modal-id="${modalId}">&times;</button>
                        </div>
                        <p class="text-gray-700 mb-6">${message}</p>
                        <div class="flex justify-end">
                            <button class="bg-blue-600 text-white px-5 py-2 rounded-md hover:bg-blue-700 transition-colors duration-200 close-modal-btn" data-modal-id="${modalId}">OK</button>
                        </div>
                    </div>
                </div>
                <style>
                    @keyframes modal-fade-in {
                        from { opacity: 0; transform: scale(0.95); }
                        to { opacity: 1; transform: scale(1); }
                    }
                    @keyframes modal-fade-out {
                        from { opacity: 1; transform: scale(1); }
                        to { opacity: 0; transform: scale(0.95); }
                    }
                </style>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            const modalElement = document.getElementById(modalId);
            modalElement.querySelectorAll('.close-modal-btn').forEach(button => {
                button.onclick = () => {
                    modalElement.style.animation = 'modal-fade-out 0.3s forwards';
                    modalElement.addEventListener('animationend', () => modalElement.remove());
                    if (callback) callback();
                };
            });
        }

        // Mobile menu toggle
        document.addEventListener('DOMContentLoaded', () => {
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const closeMobileMenuButton = document.getElementById('close-mobile-menu');
            const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
            const mobileMenu = mobileMenuOverlay.querySelector('div');

            mobileMenuButton.addEventListener('click', () => {
                mobileMenuOverlay.classList.remove('hidden');
                setTimeout(() => {
                    mobileMenu.classList.remove('translate-x-full');
                }, 10); // Small delay to allow display change to register
            });

            closeMobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.add('translate-x-full');
                mobileMenu.addEventListener('transitionend', () => {
                    mobileMenuOverlay.classList.add('hidden');
                }, { once: true });
            });

            // Close mobile menu if a link is clicked
            mobileMenu.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('translate-x-full');
                    mobileMenu.addEventListener('transitionend', () => {
                        mobileMenuOverlay.classList.add('hidden');
                    }, { once: true });
                });
            });

            // Load content for this specific page
            // Load the latest question for the "Question of the Day" section
            loadContent('answerWriting', 'qotd-content', 1, true);
            // Load all other questions for the "Previous Questions" section (excluding the latest one)
            loadContent('answerWriting', 'previous-questions-container', null, false);
        });
    </script>
    <!-- DOMPurify for sanitizing HTML content -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.3.6/purify.min.js"></script>
</body>
</html>
